{"version":3,"sources":["resilient.js"],"names":["e","exports","module","define","amd","f","window","global","self","resilient","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"root","factory","http","lil","this","VERSION","toStr","Object","prototype","toString","slicer","Array","slice","hasOwn","hasOwnProperty","origin","location","originRegex","hasDomainRequest","XDomainRequest","noop","defaults","method","timeout","auth","headers","async","withCredentials","responseType","isObj","isArr","extend","target","x","cur","args","arguments","setHeaders","xhr","defaultContent","field","setRequestHeader","getHeaders","map","getAllResponseHeaders","split","forEach","header","trim","parseData","data","contentType","getResponseHeader","responseText","JSON","parse","response","buildResponse","status","buildErrorResponse","error","message","stack","onError","cb","called","err","onLoad","readyState","isCrossOrigin","url","match","createClient","config","toUpperCase","XMLHttpRequest","open","user","password","updateProgress","ev","evt","lengthComputable","loaded","total","request","progress","stringify","errorHandler","onload","onerror","ontimeout","onabort","onprogress","send","requestFactory","options","apply","get","post","put","del","patch","head",2,"_","Cache","store","flush","key","clone","time","exists","value","set","now","./utils",3,"resolver","Client","_resilient","path","normalizeArgs","emit","requester","isFullUrl","plainHttp","mergeHttpOptions","wrapCallback","res","getHttpOptions","merge","isURI","./http","./resolver",4,"service","servers","retry","retryWait","discoverBeforeRetry","balancer","enable","roundRobin","roundRobinSize","weight","success","latency","discovery","cache","refresh","parallel","cacheExpiration","resilientOptions",5,"ResilientError","Servers","Requester","DiscoveryServers","DiscoveryResolver","getOptions","getServers","isUpdating","_updating","hasDiscoveryServers","_queue","push","updateServers","fetchServers","addTimeStamp","updateServersInParallel","onUpdateServers","buf","sort","server","index","concat","once","onUpdateInParallel","isEmptyBuffer","splice","closePendingRequests","client","close","update","fetch","indexOf","Math","floor","random","abort","filter","./discovery-servers","./error","./requester","./servers",6,"defineServers","handlerError","isValidResponse","saveServers","setServers","refreshCache","isCacheEnabled","resolveFromCache","resolveWithError","getCache","hasValidCache","_cache","valid","expires","name",7,"MESSAGES",1000,1001,1002,1003,1004,1005,1006,"create",8,"resolveModule","mapResponse","requestWrapper","setUserAgent","body","statusCode","isJSONContent","getUserAgent","LIBRARY_VERSION","../bower_components/lil-http/http",9,"Resilient","Options","ResilientFactory","CLIENT_VERSION","./client","./defaults","./options","./resilient",10,"type","getRaw","each","bind","undefined","omit","defaultOptions","keys","defineDefaults",11,"getServersList","operation","getOperation","serversList","next","previousError","shift","join","basePath","sendRequest","requestHandler","handleMissingServers","delayRetry","delay","discoveryServers","start","isUnavailableStatus","reportError","report","resolve","handler","getHttpClient","_httpClient","isInvalidStatus",12,"EventBus","VERBS","_client","setOptions","setDiscoveryOptions","setServiceOptions","list","discoverServers","flushCache","setHttpClient","restoreHttpClient","areServersUpdated","lastUpdate","defineMethodProxy","verb","./cache","./discovery-resolver","lil-event",13,"Resolver","hasServers","isUpToDate","updated","forceUpdate","handleResolution",14,"arr","size","RoundRobin","getRandom","ps","k","j","rs","pop","max","round",15,"Server","setStats","stats","getStats","calculateAvgLatency","getBalance","applyOptions","balance","calculateStatsBalance","read","createStats","write","getWeightAvg","number",16,"force","y","roundRobinSort","find","mapServers","empty","isValidURI","uri","mapServer","./roundrobin","./server",17,"Function","isArrayNative","isArray","uriRegex","Date","getTime","ctx","fn","obj","objIterator","extender","merger","ms","setTimeout","str","test","base","part","iterator","eachArgument",18,19,"Event","constructor","addListener","on","event","TypeError","findListener","getListeners","removeListener","off","listeners","listener","addOnceListener","fire","removeAllListeners","offAll","_events","events","getEvents"],"mappings":"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"}