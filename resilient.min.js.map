{"version":3,"sources":["resilient.js"],"names":["e","exports","module","define","amd","f","window","global","self","resilient","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"root","factory","http","lil","this","VERSION","toStr","Object","prototype","toString","slicer","Array","slice","hasOwn","hasOwnProperty","origin","location","originRegex","hasDomainRequest","XDomainRequest","defaults","method","timeout","auth","headers","async","withCredentials","responseType","isObj","isArr","extend","target","x","cur","args","arguments","setHeaders","xhr","defaultContent","field","setRequestHeader","getHeaders","map","getAllResponseHeaders","split","forEach","header","trim","parseData","data","contentType","getResponseHeader","responseText","JSON","parse","response","buildResponse","status","buildErrorResponse","error","message","stack","onError","cb","called","err","onLoad","readyState","isCrossOrigin","url","match","createClient","config","toUpperCase","XMLHttpRequest","open","user","password","updateProgress","ev","evt","lengthComputable","loaded","total","request","progress","stringify","errorHandler","onload","onerror","ontimeout","onabort","onprogress","send","requestFactory","options","TypeError","apply","get","post","put","del","patch","head",2,"_","requester","Client","_resilient","path","normalizeArgs","concat","httpDefaults","./requester","./utils",3,"service","servers","cache","refresh","cacheExpiration","balancer","enable","roundRobin","weight","latency","discovery","retry","retryWait","parallel","resilientOptions",4,"ResilientError","MESSAGES",1000,1001,1002,1003,1004,1005,"create",5,"resolveModule","client","requestWrapper","body","mapResponse","res","statusCode","isJSONContent","../bower_components/lil-http/http",6,"Resilient","Options","ResilientFactory","./client","./defaults","./options","./resilient",7,"Servers","type","store","clone","set","key","getRaw","buf","each","value","bind","undefined","omit","defaultOptions","keys","./servers",8,"Requester","resolve","onResolve","hasServers","getServers","getHttpOptions","handleMissingServers","getOptions","delay","_updating","operation","getOperation","sort","next","previousError","handler","server","shift","requestHandler","join","basePath","push","start","now","isUnavailableStatus","report","valid","exists","lastUpdate","updateServers","updateServersInParallel","index","onUpdate","splice","indexOf","onUpdateServers","_queue","addTimeStamp","closeBufferedRequests","defineServers","saveServers","abort","isInvalidStatus","Math","floor","random","./error","./http",9,"VERBS","_client","setOptions","setDiscoveryOptions","setClientOptions","getDefaults","defineMethodProxy","verb",10,"Server","setStats","stats","getStats","calculateAvgLatency","getBalance","balance","round","read","createStats","write","number",11,"uriRegex","updated","bestAvailable","y","find","filter","isValidURI","mapServer","empty","uri","test","./server",12,"isArrayNative","isArray","Function","noop","Date","getTime","ctx","fn","obj","pick","ms","setTimeout","base","part",13],"mappings":"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"}