{"version":3,"sources":["resilient.js"],"names":["e","exports","module","define","amd","f","window","global","self","resilient","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"_","Cache","this","store","Object","create","prototype","flush","key","emptyObject","get","clone","time","exists","value","isObj","isArr","data","set","now","./utils",2,"resolver","http","Client","_resilient","path","options","cb","send","post","put","del","delete","patch","head","method","args","normalizeArgs","requester","apply","emit","isFullUrlSchema","plainHttpRequest","arguments","mergeHttpOptions","noop","wrapCallback","once","finalRequestHandler","err","res","defaults","timeout","$timeout","merge","isURI","url","_httpClient","fn","called","./http","./resolver",3,"service","timeouts","servers","retry","retryWait","discoverBeforeRetry","promiscuousErrors","omitRetryWhen","omitFallbackWhen","omitRetryOnMethods","omitFallbackOnMethods","omitRetryOnErrorCodes","omitFallbackOnErrorCodes","balancer","enable","roundRobin","roundRobinSize","weight","success","error","latency","discovery","parallel","cacheEnabled","cacheExpiration","refreshInterval","enableRefreshServers","refreshServersInterval","refreshServers","refreshOptions","refreshPath","useDiscoveryServersToRefresh","resilientOptions",4,"ResilientError","Servers","Requester","MAX_PARALLEL","ServersDiscovery","getOptions","getServers","hasDiscoveryServers","updateServersInParallel","buf","sort","pending","counter","onServersUpdateFn","onUpdateServers","onUpdateInParallelFn","onUpdateInParallel","slice","forEach","server","index","concat","fetchServers","params","addTimeStamp","updateServers","next","handler","total","decrement","reset","extend","qs","_time","closeAndEmptyPendingRequests","isEmptyBuffer","closePendingRequest","splice","client","xhr","readyState","closeClient","abort","filter","request","./error","./requester","./servers",5,"MESSAGES",1000,1001,1002,1003,1004,1005,1006,"status","stack","message",6,"IS_BROWSER","JSON_MIME","resolveModule","HttpClient","VERSION","mapResponse","body","statusCode","isJSONContent","JSON","parse","mapOptions","setUserAgent","mapRequestBody","test","headers","getUserAgent","LIBRARY_VERSION","json","requestWrapper","lil-http",7,"Resilient","Options","ResilientFactory","CLIENT_VERSION","./client","./defaults","./options","./resilient",8,"type","omit","setServers","each","bind","undefined","getRaw","defaultOptions","keys","defineDefaults",9,"operation","getOperation","serversList","getServersList","requestNextServer","previousError","shift","defineRequestOptions","requestHandler","resolveRequest","sendRequest","handleMissingServers","getPreviousResponse","cachedPreviousResponse","responseObj","getFirstValue","shouldOmitRetryCycle","retryRequest","waitBeforeRetry","retrier","updateDiscoveryServersAndRetry","delay","resolve","nextServer","start","requestReporter","shouldOmitFallback","reportError","isErrorResponse","memoizeResponse","report","getHttpClient","push","mapAndResolve","resolution","join","basePath","getTimeout","toLowerCase","arr","v","onRetry","_state","unlock","DiscoveryResolver","update","shouldOmitOnErrorCode","shouldOmitOnMethod","shouldOmitWhenRules","shouldOmitFallbackOnErrorCode","shouldOmitFallbackOnMethod","methods","rules","ruleFilter","rule","matchRuleMethod","matchRuleStatusCode","matchHttpMethod","codes","indexOf","m","map","toUpperCase","trim","isErrorStatus","isUnavailableStatus","isInvalidStatus","checkResponseStatus",10,"EventBus","State","_client","_cache","_options","discoveryOptions","serviceOptions","getHttpOptions","serversURL","urls","discoveryServers","list","resetScore","resetStats","getUpdatedServers","latestServers","discoverServers","flushCache","useHttpClient","restoreHttpClient","areServersUpdated","lastUpdate","mock","mockFn","unmock","defineMethodProxy","verb","./cache","./resolvers/discovery","./state","lil-event",11,"Resolver","state","hasDiscoveryServersOutdated","updateDiscoveryServers","hasValidServiceServers","updateServersFromDiscovery","getRefreshServers","getRefreshOptions","locked","enqueue","onRefreshServers","lock","unlockAndDispatchDiscoveryQueue","refreshDiscoveryServers","outdated","canUpdateDiscoveryServers","handleResolution","serversAreUpdated","updated","dequeue","getRefreshBasePath","./discovery",12,"DiscoveryServersResolver","saveServers","refreshCache","handlerError","isCacheEnabled","resolveFromCache","resolveWithError","cache","getCache","hasValidCache","expires","name","defineServers","isValidResponse","valid","parseAsJSON","../error","../utils",13,"DiscoveryServers","finish","unlockAndDispatchQueue","fetch","queue","dispatcher","../discovery","../requester","./discovery-servers",14,"rrSerieGenerator","size","getRandom","ps","k","j","rs","pop","max","Math","round","random",15,"balancerOptions","Server","stats","calculateAvgLatency","balance","calculateStatsBalance","field","statsStore","createServerStats","read","createStats","write","getWeightAvg","number",16,"RoundRobin","x","y","roundRobinSort","find","mapServers","empty","isValidURI","uri","mapServer","./roundrobin","./server",17,"isArray","locks","queues","getState","task",18,"toStr","toString","Array","hasOwn","hasOwnProperty","Function","isArrayNative","uriRegex","Date","getTime","ctx","obj","ms","setTimeout","str","base","part","objIterator","extender","merger","target","iterator","iterateEachArgument",19,20,"root","factory","Event","lil","constructor","addListener","on","event","TypeError","findListener","getListeners","removeListener","off","listeners","listener","addOnceListener","fire","removeAllListeners","offAll","_events","events","getEvents",21,"slicer","hasBind","origin","location","originRegex","jsonMimeRegex","hasDomainRequest","XDomainRequest","auth","withCredentials","responseType","assign","cur","setHeaders","defaultContent","setRequestHeader","getHeaders","rawHeaders","getAllResponseHeaders","split","header","isJSONResponse","getResponseHeader","encodeParams","getOwnPropertyNames","encodeURIComponent","replace","parseData","responseText","response","getStatus","buildResponse","statusText","buildErrorResponse","cleanReferences","onreadystatechange","onerror","ontimeout","isValidResponseStatus","onError","onLoad","config","ev","isCrossOrigin","match","getURL","XHRFactory","XMLHttpRequest","createClient","open","user","password","updateProgress","lengthComputable","loaded","hasContentTypeHeader","buildPayload","stringify","timeoutResolver","timeoutId","clearTimeout","progress","errorHandler","onprogress","requestFactory"],"mappings":"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"}