/*! resilient - v0.1 - MIT License - https://github.com/resilient-http/resilient.js */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.resilient=t()}}(function(){var t,e,r;return function n(t,e,r){function i(o,u){if(!e[o]){if(!t[o]){var f=typeof require=="function"&&require;if(!u&&f)return f(o,!0);if(s)return s(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var c=e[o]={exports:{}};t[o][0].call(c.exports,function(e){var r=t[o][1][e];return i(r?r:e)},c,c.exports,n,t,e,r)}return e[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,r,n){(function(e,i){if(typeof t==="function"&&t.amd){t(["exports"],i)}else if(typeof n==="object"){i(n);if(typeof r==="object"&&r!==null){r.exports=n=n.http}}else{i(e.lil=e.lil||{})}})(this,function(t){"use strict";var e="0.1.9";var r=Object.prototype.toString;var n=Array.prototype.slice;var i=Object.prototype.hasOwnProperty;var s=location.origin;var o=/^(http[s]?:\/\/[a-z0-9\-\.\:]+)[\/]?/i;var u=/application\/json/;var f=typeof XDomainRequest!=="undefined";var a=function(){};var c={method:"GET",timeout:30*1e3,auth:null,headers:null,async:true,withCredentials:false,responseType:"text"};function l(t){return t&&r.call(t)==="[object Object]"||false}function p(t){var e,r,s,o,u=n.call(arguments).slice(1);for(e=0,r=u.length;e<r;e+=1){o=u[e];for(s in o)if(i.call(o,s))t[s]=o[s]}return t}function v(t,e){if(l(e)){e["Content-Type"]=e["Content-Type"]||C.defaultContent;for(var r in e){t.setRequestHeader(r,e[r])}}}function h(t){var e={},r=t.getAllResponseHeaders().split("\n");r.forEach(function(t){if(t){t=t.split(":");e[t[0].trim()]=(t[1]||"").trim()}});return e}function d(t){return u.test(t.getResponseHeader("Content-Type"))}function y(t){return Object.getOwnPropertyNames(t).filter(function(e){return t[e]!==undefined}).map(function(e){var r=t[e]===null?"":t[e];return encodeURIComponent(e)+(r?"="+encodeURIComponent(r):"")}).join("&").replace(/%20/g,"+")}function g(t){var e;if(t.responseType==="text"){e=t.responseText;if(d(t)&&e)e=JSON.parse(e)}else{e=t.response}return e}function m(t){return{xhr:t,status:t.status,data:g(t),headers:h(t)}}function b(t,e){var r=new Error(e.message);p(r,m(t));r.error=e;r.stack=e.stack;return r}function O(t,e){var r=false;return function(n){if(!r){e(b(t,n),null);r=true}}}function w(t,e){return function(){if(t.readyState===4){if(t.status>=200&&t.status<400){e(null,m(t))}else{e(m(t),null)}}}}function S(t){var e=t.match(o);return e&&e[1]===s}function E(t){var e=t.url;if(l(t.params)){e+=(e.indexOf("?")===-1?"?":"&")+y(t.params)}return e}function _(t){if(f&&S(t)){return new XDomainRequest}else{return new XMLHttpRequest}}function x(t){var e=(t.method||"GET").toUpperCase();var r=t.auth||{};var n=E(t);var i=_(n);i.open(e,n,t.async,r.user,r.password);i.withCredentials=t.withCredentials;i.responseType=t.responseType;i.timeout=t.timeout;v(i,t.headers);return i}function j(t,e){return function(t){if(evt.lengthComputable){e(t,evt.loaded/evt.total)}else{e(t)}}}function R(t,e,r){var n=x(t);var i=l(t.data)||Array.isArray(t.data)?JSON.stringify(t.data):t.data;var s=O(n,e);n.onload=w(n,e);n.onerror=s;n.ontimeout=s;n.onabort=s;if(typeof r==="function")n.onprogress=j(n,r);try{n.send(i)}catch(o){s(o)}return{xhr:n,config:t}}function q(t){return function(e,r,i,s){var o,u,f=null;var v=p({},c,{method:t});var h=n.call(arguments);for(o=0,u=h.length;o<u;o+=1){f=h[o];if(typeof f==="function"){i=f;if(i!==f)s=f}else if(l(f)){p(v,f)}else if(typeof f==="string"&&!v.url){v.url=f}}return R(v,i||a,s)}}function C(t,e,r,n){return q("GET").apply(null,arguments)}C.VERSION=e;C.defaults=c;C.defaultContent="text/plain";C.get=q("GET");C.post=q("POST");C.put=q("PUT");C.del=q("DELETE");C.patch=q("PATCH");C.head=q("HEAD");return t.http=C})},{}],2:[function(t,e,r){var n=t("./utils");e.exports=i;function i(){this.store={}}i.prototype.flush=function(t){if(t){this.store[t]=null}else{this.store={}}};i.prototype.get=function(t){return t?this.store[t]:n.clone(this.store)};i.prototype.time=function(t){if(t&&this.store[t]){return this.store[t].time}};i.prototype.exists=function(t){var e=this.store[t];return n.isObj(e)&&(n.isArr(e.data)&&e.data.length>0||n.isObj(e.data))||false};i.prototype.set=function(t,e){if(t&&e){this.store[t]={data:e,time:n.now()}}}},{"./utils":17}],3:[function(t,e,r){var n=t("./utils");var i=t("./resolver");var s=t("./http");e.exports=o;function o(t){this._resilient=t}o.prototype.send=function(t,e,r,n){var i=f.call(this,t,e,r,n);this._resilient.emit("request:start",i[0],this._resilient);u.apply(this,i)};o.prototype.get=function(t,e,r){return this.send(t,e,r,"GET")};o.prototype.post=function(t,e,r){return this.send(t,e,r,"POST")};o.prototype.put=function(t,e,r){return this.send(t,e,r,"PUT")};o.prototype.del=function(t,e,r){return this.send(t,e,r,"DELETE")};o.prototype.patch=function(t,e,r){return this.send(t,e,r,"PATCH")};o.prototype.head=function(t,e,r){return this.send(t,e,r,"HEAD")};function u(t,e){if(l(t)){return p(t,e)}else{return i(this._resilient,t,e)}}function f(t,e,r,i){if(typeof e==="function"){r=e;e=arguments[0]}e=c.call(this,e);if(typeof t==="string")e.path=t;if(typeof i==="string")e.method=i;if(typeof r!=="function")r=n.noop;return[e,a(this._resilient,r)]}function a(t,e){return n.once(function(r,n){t.emit("request:finish",r,n,t);e(r,n)})}function c(t){var e=this._resilient.getOptions("service").get();return n.merge(e,t)}function l(t){return t&&(n.isURI(t.path)||n.isURI(t.url))||false}function p(t,e){t.url=t.path;return s.call(null,t,e)}},{"./http":8,"./resolver":13,"./utils":17}],4:[function(t,e,r){var n=e.exports={};n.service={method:"GET",timeout:10*1e3,servers:null,retry:0,retryWait:1e3,discoverBeforeRetry:true,promiscuousErrors:false};n.balancer={enable:true,roundRobin:true,roundRobinSize:3,weight:{success:15,error:50,latency:35}};n.discovery={servers:null,method:"GET",cache:true,retry:3,retryWait:1e3,timeout:2*1e3,refreshInterval:60*1e3,enableRefreshServers:true,refreshServersInterval:60*3*1e3,refreshServers:null,parallel:true,cacheExpiration:60*10*1e3,promiscuousErrors:true};n.resilientOptions=["servers","retry","retryWait","parallel","cacheExpiration","cache","refreshInterval","refreshServers","enableRefreshServers","refreshServersInterval","discoverBeforeRetry"]},{}],5:[function(t,e,r){var n=t("./utils");var i=t("./error");var s=t("./servers");var o=t("./requester");var u=t("./discovery-servers");e.exports=f;function f(t,e){function r(){return n.merge(t.getOptions("discovery").get(),e)}function u(){return t.servers("discovery")}function f(){return t._updating}function p(){var t=u();return t&&t.exists()||false}function v(e){if(p()===false){e(new i(1002))}else if(f()){t._queue.push(e)}else{h(e)}}function h(e){try{d(e)}catch(r){t._updating=false;e(new i(1006,r))}}function d(e){var n=r();n.params=a(n);t._updating=true;if(n.parallel){y(n,e)}else{o(t)(u(),n,m(e))}}function y(e,r){var n=[],i=u().sort("read",t.balancer());i.slice(0,3).forEach(function(u,f){u=[u];if(f===2&&i.length>3){u=u.concat(i.slice(3))}o(t)(new s(u),e,g(f,n,r),n)})}function g(t,e,r){return function(n,i){if(n)e[t]=null;if(i||t===2){m(r,e)(n,i)}}}function m(t,e){return function(r,n){b(r,n);O(e);t(r||null,n)}}function b(e,r){t._updating=false;t._queue.forEach(function(t){t(e,r)});t._queue.splice(0)}function O(t){if(t){if(!l(t)){t.forEach(function(t){try{c(t)}catch(e){}})}t.splice(0)}}return v}o.DiscoveryResolver=f;f.update=function(t,e,r){f(t,e)(u(t)(r))};f.fetch=function(t,e,r){f(t,e)(function(t,e){if(t)r(t);else if(e&&e.data)r(null,e.data);else r(new i(1001,e))})};function a(t){var e=n.now()+Math.floor(Math.random()*1e4);return n.extend(t.params||t.qs||{},{_time:e})}function c(t){if(t){if(t.xhr){if(t.xhr.readyState!==4)t.xhr.abort()}else if(typeof t.abort==="function"){t.abort()}}}function l(t){return!t||t.filter(function(t){return n.isObj(t)}).length===0}},{"./discovery-servers":6,"./error":7,"./requester":11,"./servers":16,"./utils":17}],6:[function(t,e,r){var n=t("./utils");var i=t("./error");e.exports=s;function s(t){function e(t){return function(e,n){if(e){s(e,t)}else if(u(n)){r(n,t)}else{t(new i(1004,n))}}}function r(e,r){var n=e.data;v("refresh",n);t.setServers(n);c(n);r(null,e)}function s(t,e){if(l()){f(t,e)}else{o(t,e)}}function f(t,e){var r=p();if(a(r)){e(null,{status:200,_cache:true,data:r.data})}else{o(t,e)}}function a(e){var r=false,i=t.getOptions("discovery").cacheExpiration;return e&&n.isArr(e.data)&&n.now()-e.time>i||false}function c(e){if(l()){v("cache",e);t._cache.set("servers",e)}}function l(){return t.getOptions("discovery").get("cache")}function p(){return t._cache.get("servers")}function v(e,r){t.emit("discovery:"+e,r,t)}return e}function o(t,e){t=t||{status:1e3};return e(new i(t.status,t))}function u(t){var e=false;if(t){if(n.isArr(t.data)&&t.data.length){e=true}else if(typeof t.data==="string"){try{t.data=JSON.parse(t.data);e=true}catch(r){}}}return e}},{"./error":7,"./utils":17}],7:[function(t,e,r){e.exports=i;var n={1e3:"All requests failed. No servers available",1001:"Cannot update discovery servers. Empty or invalid response body",1002:"Missing discovery servers. Cannot resolve the server",1003:"Cannot resolve servers. Missing data",1004:"Discovery server response is invalid or empty",1005:"Missing servers during retry process",1006:"Internal state error"};function i(t,e){if(e instanceof Error){Error.call(this);this.error=e;if(e.code)this.code=e.code;if(e.stack)this.stack=e.stack}else if(e){this.request=e}this.status=t||1e3;this.message=n[this.status]}i.prototype=Object.create(Error.prototype);i.MESSAGES=n},{}],8:[function(t,e,r){var n=t("./utils");var i=o();e.exports=s;function s(){return i.apply(null,arguments)}s.VERSION=i.VERSION;s.mapResponse=f;function o(){if(typeof window==="object"&&window){return t("../bower_components/lil-http/http")}else{return u(t("request"))}}function u(t){return function e(r,n){if(typeof r==="string")r={url:r};r=c(r);if(r.params)r.qs=r.params;if(r.data){p(r)}return t.call(null,r,f(n))}}function f(t){return function(e,r,n){if(r){if(r.statusCode){r.status=r.statusCode}if(n){r.data=a(r)?JSON.parse(n):n}}t(e,r)}}function a(t){return typeof t.body==="string"&&/application\/json/.test(t.headers["content-type"])}function c(t){t=t||{};t.headers=t.headers||{};t.headers["User-Agent"]=t.headers["User-Agent"]||l();return t}function l(){return"resilient-http "+s.LIBRARY_VERSION+" (node)"}function p(t){var e=t.data;if(e&&n.isObj(e)||n.isArr(e)){t.json=true;t.data=null}t.body=e}},{"../bower_components/lil-http/http":1,"./utils":17,request:18}],9:[function(t,e,r){var n=t("./resilient");var i=t("./options");var s=t("./defaults");var o=t("./servers");var u=t("./client");var f=t("./http");e.exports=a;function a(t){return new n(t)}a.VERSION="0.2.0";a.CLIENT_VERSION=f.VERSION;a.defaults=s;a.Options=i;a.Servers=o;a.Client=u;a.request=f;f.LIBRARY_VERSION=a.VERSION},{"./client":3,"./defaults":4,"./http":8,"./options":10,"./resilient":12,"./servers":16}],10:[function(t,e,r){var n=t("./utils");var i=t("./defaults");var s=t("./servers");e.exports=o;function o(t,e){this.store=e?n.clone(i[e]):{};this.set(t)}o.prototype.get=function(t){return t?this.store[t]:n.clone(this.store)};o.prototype.getRaw=function(){var t={},e=this.get();if(e){n.each(e,function(e,r){if(r instanceof o){t[e]=r.get()}})}return t};o.prototype.set=function(t,e){if(n.isObj(t)){n.each(t,n.bind(this,this.set))}else if(e!==undefined){if(t==="servers"||t==="refreshServers"){this.setServers(e)}else{this.store[t]=e}}};o.prototype.http=function(){return n.omit(this.store,i.resilientOptions)};o.prototype.servers=function(t){return t?this.setServers(t):this.store.servers};o.prototype.setServers=function(t){if(this.store.servers){this.store.servers.set(t)}else{this.store.servers=new s(t)}};o.prototype.clone=function(){return o.define(this.getRaw())};o.define=function(t,e){var r=new o;e=n.clone(e||i);Object.keys(e).forEach(u(t,r));return r};function u(t,e){t=n.isObj(t)?t:{};return function(r){if(r!=="resilientOptions"){e.set(r,new o(t[r],r))}}}},{"./defaults":4,"./servers":16,"./utils":17}],11:[function(t,e,r){var n=t("./utils");var i=t("./http");var s=t("./defaults").resilientOptions;var o=t("./error");var u=t("./discovery-servers");e.exports=f;function f(t){function e(e,r){if(t.balancer().get("enable")){return e.sort(r,t.balancer())}else{return e.get()}}function r(r,i,o,u){var f=d(i.method);var c=e(r,f);i=n.clone(i);function l(e){var v=c.shift();if(v){i.url=n.join(v.url,i.basePath,i.path);a(t,i,p(v,f,i,o,l),u)}else{s(r,i,e,o)}}l()}function s(e,r,n,i){var s=null;if(r.retry){s=u(e,r,i);if(r.discoverBeforeRetry&&t.hasDiscoveryServers()){t._updating=false;f.DiscoveryResolver.update(t,null,s)}else{s()}}else{i(new o(1e3,n))}}function u(t,e,r){return function(){n.delay(c(t,e,r),e.retryWait)}}function c(e,n,i){return function(){if(e.exists()){n.retry-=1;t.emit("request:retry",n,e);r(e,n,i)}else{i(new o(1005))}}}function p(t,e,r,i,s){var o=n.now();return function(u,f){var a=n.now()-o;if(h(r,u,f)){t.reportError(e,a);s(u)}else{t.report(e,a);y(f,i)}}}function h(t,e,r){return t.promiscuousErrors&&v(e||r)||l(e,r)}function y(t,e){i.mapResponse(e)(null,t,t.body)}function g(e){return t.getOptions(e||"service")}return r}function a(t,e,r,i){var o=null;try{o=c(t)(n.omit(e,s),r);if(i)i.push(o)}catch(u){r(u)}}function c(t){return typeof t._httpClient==="function"?t._httpClient:i}function l(t,e){return t&&t.code!==undefined||e==undefined||p(t||e)||false}function p(t){return h(429,t)}function v(t){return h(400,t)}function h(t,e){return e&&(e.code||e.status>=t||e.status===0)||false}function d(t){return!t||t.toUpperCase()==="GET"?"read":"write"}function y(t){if(t&&t.body&&!t.data)t.data=t.body;return t}},{"./defaults":4,"./discovery-servers":6,"./error":7,"./http":8,"./utils":17}],12:[function(t,e,r){var n=t("./utils");var i=t("./options");var s=t("./client");var o=t("./cache");var u=t("./discovery-resolver");var f=t("lil-event");e.exports=a;function a(t){this._options=null;this._queue=[];this._updating=false;this._client=new s(this);this._cache=new o;this._httpClient=null;this.setOptions(t)}a.prototype=Object.create(f.prototype);a.prototype.setOptions=function(t,e){var r=null;if(t&&n.isObj(e)){r=this._options.get(t);if(r instanceof i)r.set(e)}else{this._options=i.define(t)}};a.prototype.setDiscoveryOptions=function(t){this.setOptions("discovery",t);return this};a.prototype.setServiceOptions=function(t){this.setOptions("service",t);return this};a.prototype.getOptions=function(t){return t?this._options.get(t):this._options};a.prototype.getHttpOptions=function(t){var e=this._options.get(t||"service");if(e)return e.http()};a.prototype.servers=function(t){var e=this._options.get(t||"service");if(e)return e.servers()};a.prototype.discoveryServers=function(t){if(n.isArr(t)){this._options.get("discovery").servers(t)}else{return this.servers("discovery")}};a.prototype.hasDiscoveryServers=function(){var t=this.discoveryServers();return n.isObj(t)&&t.exists()||false};a.prototype.setServers=function(t){this._options.get("service").servers(t);return this};a.prototype.discoverServers=function(t,e){return p.call(this,"fetch",t,e)};a.prototype.getUpdatedServers=a.prototype.getLatestServers=function(t,e){e=typeof t==="function"?t:e;if(this.discoveryServers()){this.discoverServers(t,e)}else if(this.servers("service")){e(null,this.servers("service").urls())}else{e(new Error("Missing servers"))}return this};a.prototype.updateServers=function(t,e){return p.call(this,"update",t,e)};a.prototype.flushCache=function(){this._cache.flush();return this};a.prototype.setHttpClient=function(t){if(typeof t==="function"){this._httpClient=t}};a.prototype.restoreHttpClient=function(){this._httpClient=null};a.prototype.areServersUpdated=function(){return this.servers("service").lastUpdate()<(this.getOptions("discovery").get("refreshInterval")||0)};a.prototype.balancer=function(t){if(t){this._options.get("balancer").set(t)}else{return this.getOptions("balancer")}};a.prototype.client=a.prototype.http=function(){return this._client};a.prototype.send=a.prototype.request=function(t,e,r){return this._client.send(t,e,r)};a.prototype.mock=function(t){this.setHttpClient(function(e,r){n.delay(function(){t(e,r)})});return this};a.prototype.unmock=function(){this.restoreHttpClient()};var c=["get","post","put","del","head","patch"];c.forEach(l);function l(t){a.prototype[t]=function(e,r,n){return this._client[t](e,r,n)}}function p(t,e,r){if(typeof e==="function"){r=e;e=null}u[t](this,e,r||n.noop);return this}},{"./cache":2,"./client":3,"./discovery-resolver":5,"./options":10,"./utils":17,"lil-event":19}],13:[function(t,e,r){var n=t("./utils");var i=t("./error");var s=t("./requester");var o=t("./discovery-resolver");var u=t("./servers");e.exports=f;function f(t,e,r){try{f(p)}catch(n){r(new i(1006,n))}function f(t){if(c("service")){t()}else if(c("discovery")){a(t)}else{t(new i(1002))}}function a(e){o.update(t,null,e)}function c(e){var r,n=false;r=t.servers(e);if(r&&r.exists()){n=e!=="discovery"?l(r):true}return n}function l(e){var r=true;var e=t.servers("discovery");if(e&&e.exists()){r=e.forceUpdate()||e.lastUpdate()<t.getOptions("discovery").get("refreshInterval")}return r}function p(t,e){if(t){r(t)}else{v(e)}}function v(n){var o=t.servers();if(n&&n._cache){o=new u(n.data)}else if(!c("service")){return r(new i(1003))}s(t)(o,e,r)}}},{"./discovery-resolver":5,"./error":7,"./requester":11,"./servers":16,"./utils":17}],14:[function(t,e,r){e.exports=n;function n(t,e){e=e<2?2:e;return i(e,t)[s(e)].shift()}function i(t,e){var r,n,i,s=[];if(!e){e=[];for(r=1;r<=t;r+=1)e.push(r)}else{e=e.slice()}if(t%2===1){e.push(-1);t+=1}for(n=0;n<t-1;n+=1){s[n]=[];for(i=0;i<t/2;i+=1){if(e[i]!==-1&&e[t-1-i]!==-1){s[n].push([e[i],e[t-1-i]])}}e.splice(1,0,e.pop())}return s}function s(t){t=t>0?t-1:t;return Math.round(Math.random()*(t-0)+0)}},{}],15:[function(t,e,r){var n=t("./utils");var i=t("./defaults");e.exports=s;function s(t,e){this.url=t;this.setStats();this.setOptions(e)}s.prototype.report=function(t,e,r){var n=this.getStats(t);if(n){n[r||"request"]+=1;if(e){n.latency=a(e,n)}}};s.prototype.reportError=function(t,e){this.report(t,e,"error")};s.prototype.getBalance=function(t,e){var r=this.getStats(t);var n=this.applyOptions(e).weight;var i=r.request+r.error;return i===0?0:f(r,n,i)};s.prototype.getStats=function(t,e){var r=this.stats[t||"read"];if(r&&e)r=r[e];return r};s.prototype.setOptions=function(t){this.options=n.merge({},i.balancer,t)};s.prototype.applyOptions=function(t){if(n.isObj(t)){return n.merge({},this.options,t)}else{return this.options}};s.prototype.setStats=function(t){this.stats=t||{read:o(),write:o()}};function o(){return{latency:0,error:0,request:0}}function u(){return stats.request*100/total*weight.success}function f(t,e,r){return c((t.request*100/r*e.success+t.error*100/r*e.error+t.latency*e.latency)/100)}function a(t,e){return c((t+e.latency)/(e.request+e.error))}function c(t){return Math.round(t*100)/100}},{"./defaults":4,"./utils":17}],16:[function(t,e,r){var n=t("./utils");var i=t("./server");var s=t("./roundrobin");e.exports=o;function o(t){this.servers=[];this.updated=0;this.force=false;this.set(t)}o.prototype.sort=function(t,e){var r=this.servers.slice(0).sort(function(r,n){return r.getBalance(t,e)-n.getBalance(t,e)});return c(r,e)};o.prototype.find=function(t){var e,r,n=null;for(e=0,r=this.servers.length;e<r;e+=1){if(this.servers[e].url===t){n=this.servers[e];break}}return n};o.prototype.get=function(){return this.servers.slice(0)};o.prototype.set=function(t){if(n.isArr(t)){this.force=true;this.updated=n.now();this.servers=f.call(this,t)}};o.prototype.lastUpdate=function(){return n.now()-this.updated};o.prototype.empty=function(){return this.servers.length===0};o.prototype.exists=function(){return this.size()>0};o.prototype.size=function(){return this.servers.length};o.prototype.forceUpdate=function(){var t=this.force;if(t)this.force=false;return t};o.prototype.urls=function(){return this.servers.map(function(t){return t.url})};function u(t){if(n.isObj(t))t=t.url||t.uri;return n.isURI(t)}function f(t){return t.filter(u).map(n.bind(this,a))}function a(t){var e;if(t instanceof i){e=t}else{e=this.find(n.isObj(t)?t.url:t);if(!e)e=new i(t)}return e}function c(t,e){var r=0;if(e&&e.roundRobin){r=e.roundRobinSize>t.length?t.length:e.roundRobinSize;if(r>1)t=s(t,r)}return t}},{"./roundrobin":14,"./server":15,"./utils":17}],17:[function(t,e,r){var n=r;var i=Object.prototype.toString;var s=Array.prototype.slice;var o=Object.prototype.hasOwnProperty;var u=Function.prototype.bind;var f=Array.isArray;var a=/^http[s]?\:\/\/(.+)/i;n.noop=function(){};n.now=function(){return(new Date).getTime()};n.isObj=function(t){return t&&i.call(t)==="[object Object]"||false};n.isArr=function(t){return t&&f?f(t):i.call(t)==="[object Array]"||false};n.bind=function(t,e){return u?e.bind(t):function(){return e.apply(t,arguments)}};n.each=function(t,e){var r,i;if(n.isArr(t))for(r=0,i=t.length;r<i;r+=1)e(t[r],r);else if(n.isObj(t))for(r in t)if(o.call(t,r))e(r,t[r])};n.once=function(t){var e=false;return function(){if(e===false){e=true;t.apply(null,arguments)}}};n.extend=l(c);n.merge=l(v);n.clone=function(t){return n.extend({},t)};n.omit=function(t,e){var r,i={};if(n.isObj(t)){for(r in t)if(o.call(t,r)){if(e.indexOf(r)===-1)i[r]=t[r]}}return i};n.delay=function(t,e){return setTimeout(t,e||1)};n.isURI=function(t){return typeof t==="string"&&a.test(t)};n.join=function(t){return(t||"")+s.call(arguments,1).filter(function(t){return typeof t==="string"&&t.length>0}).join("")};function c(t,e,r){t[e]=r}function l(t){return function(e){n.each(s.call(arguments,1),p(e,t));return e}}function p(t,e){return function(r){if(n.isObj(r)){n.each(r,function(r,n){e(t,r,n)})}}}function v(t,e,r){if(n.isObj(r)&&n.isObj(t[e])){n.merge(t[e],r)}else{c(t,e,r)}}},{}],18:[function(t,e,r){},{}],19:[function(e,r,n){(function(e,i){if(typeof t==="function"&&t.amd){t(["exports"],i)}else if(typeof n==="object"){i(n);if(typeof r==="object"&&r!==null){r.exports=n.Event}}else{i(e.lil=e.lil||{})}})(this,function(t){"use strict";var e="0.1.3";var r=Array.prototype.slice;var n=Object.prototype.hasOwnProperty;function i(){}i.prototype.constructor=i;i.prototype.addListener=i.prototype.on=function(t,e,r){if(typeof t!=="string")throw new TypeError("First argument must be a string");if(typeof e!=="function")throw new TypeError("Second argument must be a function");if(!s.call(this,t,e)){o.call(this,t).push({fn:e,once:r||false})}return this};i.prototype.removeListener=i.prototype.off=function(t,e){var r;var n=o.call(this,t);var i=s.call(this,t,e);if(i){r=n.indexOf(i);if(r>=0)n.splice(r,1)}return this};i.prototype.addOnceListener=i.prototype.once=function(t,e,r){this.addListener(t,e,true);return this};i.prototype.emit=i.prototype.fire=function(t){var e,n,i,s=r.call(arguments).slice(1);var u=o.call(this,t);if(t){for(e=0,n=u.length;e<n;e+=1){i=u[e];if(i.once)u.splice(e,1);i.fn.apply(null,s)}}return this};i.prototype.removeAllListeners=i.prototype.offAll=function(t){if(t&&n.call(this._events,t)){this._events[t].splice(0)}return this};function s(t,e){var r,n,i,s=o.call(this,t);for(r=0,n=s.length;r<n;r+=1){i=s[r];if(i.fn===e)return i}}function o(t,e){var r=u.call(this);return n.call(r,t)?r[t]:r[t]=[]}function u(){return this._events||(this._events={})}i.VERSION=e;t.Event=i})},{}]},{},[9])(9)});
//# sourceMappingURL=resilient.min.js.map